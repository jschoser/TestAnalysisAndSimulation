import xarray as xr
import cartopy.crs as ccrs
import matplotlib.pyplot as plt
import numpy as np

filename = "Data/AvEmFluxes.nc4"

DS = xr.open_dataset(filename)  # extract data set from netCFD file
da = DS.FUELBURN  # retrieve data array containing 24h average PM25 concentrations (21 days, 72 levels)

ground = da.sel(lev = np.arange(1,8,1), method = 'nearest').mean(dim = 'lev')
cruise = da.sel(lev = np.arange(28,32,1), method = 'nearest').mean(dim = 'lev')

"""
proj = ccrs.PlateCarree()  # select projection. Only seems to work with PlateCarree though

ax = plt.axes([0.1, 0.55, 0.8, 0.4], projection=proj)  # create axes
ax.coastlines(resolution='50m')  # draw coastlines with given resolution

# plot data
ax.pcolormesh(da.lon, da.lat, cruise, transform=proj)
cruise.plot()


#ax.pcolormesh(da.lon, da.lat, ground, transform=proj)
#ground.plot()
plt.show()
"""
# select projection. Only seems to work with PlateCarree though
proj = ccrs.PlateCarree()

# create axes
ax = plt.axes(projection=proj)

# draw coastlines with given resolution
ax.coastlines(resolution='50m')

# Plot the result
im = cruise.plot.pcolormesh(ax=ax, cmap='coolwarm',
                                add_colorbar = False)

# Make a colorbar
cb = plt.colorbar(im, orientation="vertical", shrink = 0.53)

# Set axis size to avoid white edges
plt.axis([-27, 47, 33, 67])

# This line sets an empty title, because otherwise xarray automatically sets
ax.set_title("")



# Show the plot
plt.show()
